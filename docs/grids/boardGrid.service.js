"use strict";

angular.module("grids").service("BoardGridService", function () {

	var emptyBoard = true;

	var numberStack = [];

	var currentNumber = null;
	var currentOperation = null;
	var currentOperationResult = null;

	var decimalCreated = false;

	var inputDirty = false;

	if (emptyBoard) {

		currentNumber = "0";
	}

	var isInt = function isInt(num) {

		return num % 1 === 1;
	};

	this.appendDigit = function (digit) {

		/**
   * currentNumber = "" -> prepares board to remove placeholder numbers
   * when a new number sequence is detected
   */

		if (emptyBoard) {

			currentNumber = "";
			emptyBoard = false;
		}

		if (!inputDirty) {

			if (digit === 0) {

				currentNumber = 0;

				return;
			} else if (digit === "." && !decimalCreated) {

				currentNumber = "0.";
				inputDirty = true;
				decimalCreated = true;
				return;
			}

			currentNumber = "";
		}

		if (digit === "." && !decimalCreated) {

			decimalCreated = true;
		} else if (digit === ".") {

			return;
		}

		/**
   * The current number has to be created as a string, or else,
   * if you add the (-) sign in the middle of keying a number
   * the number after the (-) will trigger an operation.
   */

		currentNumber += digit.toString();

		console.log("currentNumber: " + currentNumber);

		inputDirty = true;
	};

	this.getCurrentNumber = function () {

		return currentNumber;
	};

	var executeOperation = function executeOperation() {

		console.log("Executing " + currentOperation);

		var digitA = numberStack.shift();
		var digitB = numberStack.shift();

		switch (currentOperation) {

			case "addition":

				if (!isInt(digitA) || !isInt(digitB)) {

					currentOperationResult = parseFloat(digitA) + digitB;
				} else {

					currentOperationResult = digitA + digitB;
				}

				break;
			case "subtraction":

				if (!isInt(digitA) || !isInt(digitB)) {

					currentOperationResult = parseFloat(digitA) - digitB;
				} else {

					currentOperationResult = digitA - digitB;
				}

				break;
			case "multiplication":

				if (!isInt(digitA) || !isInt(digitB)) {

					currentOperationResult = parseFloat(digitA) * digitB;
				} else {

					currentOperationResult = digitA * digitB;
				}

				break;
			case "division":

				if (!isInt(digitA) || !isInt(digitB)) {

					currentOperationResult = parseFloat(digitA) / digitB;
				} else {

					currentOperationResult = digitA / digitB;
				}

				break;

			case "percentage":

				if (digitB === undefined) {

					currentOperationResult = parseFloat(digitA / 100);
				} else {

					numberStack.push(Number(digitA));
					numberStack.push(parseFloat(digitA * parseFloat(digitB / 100)));

					return;
				}

				break;

			default:
				console.log("Operation " + currentOperation + " has not been created.");

		}

		if (isInt(currentOperationResult)) {

			console.log("Result is an integer!");
		} else {

			console.log("Result is a float!");

			if (currentOperationResult < 1) {

				console.log(currentOperationResult);

				if (currentOperationResult.toString().length > 16) {

					currentOperationResult = parseFloat(currentOperationResult).toFixed(15);
				}
			}
		}

		console.log("Result: " + currentOperationResult);

		currentNumber = currentOperationResult;
	};

	this.setCurrentOperation = function (op) {

		if (op === "resultant") {

			if (numberStack === 2) {

				executeOperation();

				numberStack.push(Number(currentNumber));

				console.log(numberStack);

				inputDirty = false;
			}
		}

		/**
   * If there is nothing in numberStack & there is no input, do nothing
   * If there is nothing in numberStack & there is input, define an operation
   */

		if (numberStack.length === 0 && !inputDirty) {

			console.log("There is nothing to operate on");
		} else if (numberStack.length === 0 && inputDirty) {

			console.log("There is something to put in the stack!");

			currentOperation = op;

			numberStack.push(Number(currentNumber));
			console.log(numberStack);
			inputDirty = false;
		}

		/** If there is one element in numberStack & there is no input,
   * define an operation or allow to switch operations
   * If there is one element in numberStack & there is input,
   * push the input into numberStack
   */

		if (numberStack.length === 1 && !inputDirty) {

			console.log("There is an element in the stack");
			currentOperation = op;
			console.log(currentOperation);

			if (op === "percentage") {

				executeOperation();
				numberStack.push(Number(currentNumber));
			}
		} else if (numberStack.length === 1 && inputDirty) {

			numberStack.push(Number(currentNumber));
			console.log(numberStack);
			inputDirty = false;

			/**
    * This will make the execution block to run.
    * The operation that was assigned to trigger the execution
    * will be stored after the execution is done as it will
    * leave one element in the stack ready to an operation
    */
		}

		/**
   * If there are two elements in numberStack,
   * execute the current operation
   */

		if (numberStack.length === 2) {

			console.log("Execute Operation");

			/**
    * The current operation could change prior to computation
    * when using the percentage operator (%) as a binary operator
    */

			if (op === "percentage") {

				var ongoingOp = currentOperation;

				currentOperation = op;
				executeOperation();

				currentOperation = ongoingOp;
				executeOperation();

				numberStack.push(Number(currentNumber));

				return;
			}

			executeOperation();

			// Operation is complete. Add result to numberStack

			numberStack.push(Number(currentNumber));

			console.log(numberStack);

			currentOperation = op;
			console.log(currentOperation);
		}
	};

	this.clearBoard = function () {

		console.log("CLEAR");

		emptyBoard = true;

		numberStack.length = 0;

		currentNumber = 0;
		currentOperation = null;
		currentOperationResult = null;

		decimalCreated = false;

		inputDirty = false;
	};

	this.flipSign = function () {

		console.log("flipSign");

		if (currentNumber == 0 || emptyBoard) {

			/**
    * Avoid NaN
    */

			return;
		}

		if (numberStack.length === 1 && !inputDirty) {

			var tempNum = numberStack.pop();

			currentNumber = tempNum * -1;

			numberStack.push(Number(currentNumber));
		} else {

			console.log(numberStack);

			currentNumber = currentNumber * -1;
		}
	};
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdyaWRzL2JvYXJkR3JpZC5zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJzZXJ2aWNlIiwiZW1wdHlCb2FyZCIsIm51bWJlclN0YWNrIiwiY3VycmVudE51bWJlciIsImN1cnJlbnRPcGVyYXRpb24iLCJjdXJyZW50T3BlcmF0aW9uUmVzdWx0IiwiZGVjaW1hbENyZWF0ZWQiLCJpbnB1dERpcnR5IiwiaXNJbnQiLCJudW0iLCJhcHBlbmREaWdpdCIsImRpZ2l0IiwidG9TdHJpbmciLCJjb25zb2xlIiwibG9nIiwiZ2V0Q3VycmVudE51bWJlciIsImV4ZWN1dGVPcGVyYXRpb24iLCJkaWdpdEEiLCJzaGlmdCIsImRpZ2l0QiIsInBhcnNlRmxvYXQiLCJ1bmRlZmluZWQiLCJwdXNoIiwiTnVtYmVyIiwibGVuZ3RoIiwidG9GaXhlZCIsInNldEN1cnJlbnRPcGVyYXRpb24iLCJvcCIsIm9uZ29pbmdPcCIsImNsZWFyQm9hcmQiLCJmbGlwU2lnbiIsInRlbXBOdW0iLCJwb3AiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBQSxRQUFRQyxNQUFSLENBQWUsT0FBZixFQUNFQyxPQURGLENBQ1Usa0JBRFYsRUFDOEIsWUFBWTs7QUFFeEMsS0FBSUMsYUFBYSxJQUFqQjs7QUFFQSxLQUFNQyxjQUFjLEVBQXBCOztBQUVBLEtBQUlDLGdCQUFnQixJQUFwQjtBQUNBLEtBQUlDLG1CQUFtQixJQUF2QjtBQUNBLEtBQUlDLHlCQUF5QixJQUE3Qjs7QUFFQSxLQUFJQyxpQkFBaUIsS0FBckI7O0FBRUEsS0FBSUMsYUFBYSxLQUFqQjs7QUFHQSxLQUFJTixVQUFKLEVBQWdCOztBQUVmRSxrQkFBZ0IsR0FBaEI7QUFFQTs7QUFFRCxLQUFJSyxRQUFRLFNBQVJBLEtBQVEsQ0FBVUMsR0FBVixFQUFlOztBQUUxQixTQUFPQSxNQUFNLENBQU4sS0FBWSxDQUFuQjtBQUVBLEVBSkQ7O0FBT0EsTUFBS0MsV0FBTCxHQUFtQixVQUFVQyxLQUFWLEVBQWlCOztB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QUVBQyxlQUFhLEtBQWI7QUFFQSxFQWhCRDs7QUFrQkEsTUFBS3VCLFFBQUwsR0FBZ0IsWUFBWTs7QUFFM0JqQixVQUFRQyxHQUFSLENBQVksVUFBWjs7QUFFQSxNQUFJWCxpQkFBaUIsQ0FBakIsSUFBc0JGLFVBQTFCLEVBQXNDOztBQUVyQzs7OztBQUlBO0FBRUE7O0FBR0QsTUFBSUMsWUFBWXNCLE1BQVosS0FBdUIsQ0FBdkIsSUFBNEIsQ0FBQ2pCLFVBQWpDLEVBQTZDOztBQUU1QyxPQUFJd0IsVUFBVTdCLFlBQVk4QixHQUFaLEVBQWQ7O0FBRUE3QixtQkFBZ0I0QixVQUFVLENBQUMsQ0FBM0I7O0FBRUE3QixlQUFZb0IsSUFBWixDQUFpQkMsT0FBT3BCLGFBQVAsQ0FBakI7QUFFQSxHQVJELE1BUU87O0FBRU5VLFdBQVFDLEdBQVIsQ0FBWVosV0FBWjs7QUFFQUMsbUJBQWdCQSxnQkFBZ0IsQ0FBQyxDQUFqQztBQUVBO0FBRUQsRUEvQkQ7QUFpQ0EsQ0EzWEYiLCJmaWxlIjoiZ3JpZHMvYm9hcmRHcmlkLnNlcnZpY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuYW5ndWxhci5tb2R1bGUoXCJncmlkc1wiKVxuXHQuc2VydmljZShcIkJvYXJkR3JpZFNlcnZpY2VcIiwgZnVuY3Rpb24gKCkge1xuXHRcdFxuXHRcdGxldCBlbXB0eUJvYXJkID0gdHJ1ZTtcblx0XHRcblx0XHRjb25zdCBudW1iZXJTdGFjayA9IFtdO1xuXHRcdFxuXHRcdGxldCBjdXJyZW50TnVtYmVyID0gbnVsbDtcblx0XHRsZXQgY3VycmVudE9wZXJhdGlvbiA9IG51bGw7XG5cdFx0bGV0IGN1cnJlbnRPcGVyYXRpb25SZXN1bHQgPSBudWxsO1xuXHRcdFxuXHRcdGxldCBkZWNpbWFsQ3JlYXRlZCA9IGZhbHNlO1xuXHRcdFxuXHRcdGxldCBpbnB1dERpcnR5ID0gZmFsc2U7XG5cdFx0XG5cdFx0XG5cdFx0aWYgKGVtcHR5Qm9hcmQpIHtcblx0XHRcdFxuXHRcdFx0Y3VycmVudE51bWJlciA9IFwiMFwiO1xuXHRcdFx0XG5cdFx0fVxuXHRcdFxuXHRcdGxldCBpc0ludCA9IGZ1bmN0aW9uIChudW0pIHtcblx0XHRcdFxuXHRcdFx0cmV0dXJuIG51bSAlIDEgPT09IDE7XG5cdFx0XHRcblx0XHR9O1xuXHRcdFxuXHRcdFxuXHRcdHRoaXMuYXBwZW5kRGlnaXQgPSBmdW5jdGlvbiAoZGlnaXQpIHtcblx0XHRcdFxuXHRcdFx0LyoqXG5cdFx0XHQgKiBjdXJyZW50TnVtYmVyID0gXCJcIiAtPiBwcmVwYXJlcyBib2FyZCB0byByZW1vdmUgcGxhY2Vob2xkZXIgbnVtYmVyc1xuXHRcdFx0ICogd2hlbiBhIG5ldyBudW1iZXIgc2VxdWVuY2UgaXMgZGV0ZWN0ZWRcblx0XHRcdCAqL1xuXHRcdFx0XG5cdFx0XHRcblx0XHRcdGlmIChlbXB0eUJvYXJkKSB7XG5cdFx0XHRcdFxuXHRcdFx0XHRjdXJyZW50TnVtYmVyID0gXCJcIjtcblx0XHRcdFx0ZW1wdHlCb2FyZCA9IGZhbHNlO1xuXHRcdFx0XHRcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYgKCFpbnB1dERpcnR5KSB7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAoZGlnaXQgPT09IDApIHtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRjdXJyZW50TnVtYmVyID0gMDtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XG5cdFx0XHRcdH0gZWxzZSBpZiAoZGlnaXQgPT09IFwiLlwiICYmICFkZWNpbWFsQ3JlYXRlZCkge1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGN1cnJlbnROdW1iZXIgPSAgXCIwLlwiO1xuXHRcdFx0XHRcdGlucHV0RGlydHkgPSB0cnVlO1xuXHRcdFx0XHRcdGRlY2ltYWxDcmVhdGVkID0gdHJ1ZTtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGN1cnJlbnROdW1iZXIgPSBcIlwiO1xuXHRcdFx0XHRcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYgKGRpZ2l0ID09PSBcIi5cIiAmJiAhZGVjaW1hbENyZWF0ZWQpIHtcblx0XHRcdFx0XG5cdFx0XHRcdGRlY2ltYWxDcmVhdGVkID0gdHJ1ZTtcblx0XHRcdFx0XG5cdFx0XHR9IGVsc2UgaWYgKGRpZ2l0ID09PSBcIi5cIikge1xuXHRcdFx0XHRcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0LyoqXG5cdFx0XHQgKiBUaGUgY3VycmVudCBudW1iZXIgaGFzIHRvIGJlIGNyZWF0ZWQgYXMgYSBzdHJpbmcsIG9yIGVsc2UsXG5cdFx0XHQgKiBpZiB5b3UgYWRkIHRoZSAoLSkgc2lnbiBpbiB0aGUgbWlkZGxlIG9mIGtleWluZyBhIG51bWJlclxuXHRcdFx0ICogdGhlIG51bWJlciBhZnRlciB0aGUgKC0pIHdpbGwgdHJpZ2dlciBhbiBvcGVyYXRpb24uXG5cdFx0XHQgKi9cblx0XHRcdFxuXHRcdFx0Y3VycmVudE51bWJlciArPSBkaWdpdC50b1N0cmluZygpO1xuXHRcdFx0XG5cdFx0XHRjb25zb2xlLmxvZyhgY3VycmVudE51bWJlcjogJHtjdXJyZW50TnVtYmVyfWApO1xuXHRcdFx0XG5cdFx0XHRpbnB1dERpcnR5ID0gdHJ1ZTtcblx0XHRcdFxuXHRcdH07XG5cdFx0XG5cdFx0dGhpcy5nZXRDdXJyZW50TnVtYmVyID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0XHRyZXR1cm4gY3VycmVudE51bWJlcjtcblxuXHRcdH07XG5cdFx0XG5cdFx0Y29uc3QgZXhlY3V0ZU9wZXJhdGlvbiA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFxuXHRcdFx0Y29uc29sZS5sb2coYEV4ZWN1dGluZyAke2N1cnJlbnRPcGVyYXRpb259YCk7XG5cdFx0XHRcblx0XHRcdGNvbnN0IGRpZ2l0QSA9IG51bWJlclN0YWNrLnNoaWZ0KCk7XG5cdFx0XHRjb25zdCBkaWdpdEIgPSBudW1iZXJTdGFjay5zaGlmdCgpO1xuXHRcdFx0XG5cdFx0XHRzd2l0Y2ggKGN1cnJlbnRPcGVyYXRpb24pIHtcblx0XHRcdFx0XG5cdFx0XHRcdGNhc2UgXCJhZGRpdGlvblwiOlxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmICghaXNJbnQoZGlnaXRBKSB8fCAhaXNJbnQoZGlnaXRCKSkge1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRjdXJyZW50T3BlcmF0aW9uUmVzdWx0ID0gcGFyc2VGbG9hdChkaWdpdEEpICsgZGlnaXRCO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Y3VycmVudE9wZXJhdGlvblJlc3VsdCA9IGRpZ2l0QSArIGRpZ2l0Qjtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBcInN1YnRyYWN0aW9uXCI6XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYgKCFpc0ludChkaWdpdEEpIHx8ICFpc0ludChkaWdpdEIpKSB7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGN1cnJlbnRPcGVyYXRpb25SZXN1bHQgPSBwYXJzZUZsb2F0KGRpZ2l0QSkgLSBkaWdpdEI7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRjdXJyZW50T3BlcmF0aW9uUmVzdWx0ID0gZGlnaXRBIC0gZGlnaXRCO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFwibXVsdGlwbGljYXRpb25cIjpcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAoIWlzSW50KGRpZ2l0QSkgfHwgIWlzSW50KGRpZ2l0QikpIHtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Y3VycmVudE9wZXJhdGlvblJlc3VsdCA9IHBhcnNlRmxvYXQoZGlnaXRBKSAqIGRpZ2l0Qjtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGN1cnJlbnRPcGVyYXRpb25SZXN1bHQgPSBkaWdpdEEgKiBkaWdpdEI7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJkaXZpc2lvblwiOlxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmICghaXNJbnQoZGlnaXRBKSB8fCAhaXNJbnQoZGlnaXRCKSkge1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRjdXJyZW50T3BlcmF0aW9uUmVzdWx0ID0gcGFyc2VGbG9hdChkaWdpdEEpIC8gZGlnaXRCO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Y3VycmVudE9wZXJhdGlvblJlc3VsdCA9IGRpZ2l0QSAvIGRpZ2l0Qjtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcblx0XHRcdFx0Y2FzZSBcInBlcmNlbnRhZ2VcIjpcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAoZGlnaXRCID09PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Y3VycmVudE9wZXJhdGlvblJlc3VsdCA9IHBhcnNlRmxvYXQoZGlnaXRBIC8gMTAwKTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdG51bWJlclN0YWNrLnB1c2goTnVtYmVyKGRpZ2l0QSkpO1xuXHRcdFx0XHRcdFx0bnVtYmVyU3RhY2sucHVzaChwYXJzZUZsb2F0KGRpZ2l0QSAqIHBhcnNlRmxvYXQoZGlnaXRCIC8gMTAwKSkpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0Y29uc29sZS5sb2coYE9wZXJhdGlvbiAke2N1cnJlbnRPcGVyYXRpb259IGhhcyBub3QgYmVlbiBjcmVhdGVkLmApO1xuXHRcdFx0XHRcdFxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRcblx0XHRcdGlmIChpc0ludChjdXJyZW50T3BlcmF0aW9uUmVzdWx0KSkge1xuXHRcdFx0XHRcblx0XHRcdFx0Y29uc29sZS5sb2coYFJlc3VsdCBpcyBhbiBpbnRlZ2VyIWApO1xuXHRcdFx0XHRcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFxuXHRcdFx0XHRjb25zb2xlLmxvZyhgUmVzdWx0IGlzIGEgZmxvYXQhYCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAoY3VycmVudE9wZXJhdGlvblJlc3VsdCA8IDEpIHtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhjdXJyZW50T3BlcmF0aW9uUmVzdWx0KTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAoY3VycmVudE9wZXJhdGlvblJlc3VsdC50b1N0cmluZygpLmxlbmd0aCA+IDE2KSB7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGN1cnJlbnRPcGVyYXRpb25SZXN1bHQgPSBwYXJzZUZsb2F0KGN1cnJlbnRPcGVyYXRpb25SZXN1bHQpLnRvRml4ZWQoMTUpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRjb25zb2xlLmxvZyhgUmVzdWx0OiAke2N1cnJlbnRPcGVyYXRpb25SZXN1bHR9YCk7XG5cdFx0XHRcblx0XHRcdGN1cnJlbnROdW1iZXIgPSBjdXJyZW50T3BlcmF0aW9uUmVzdWx0O1xuXHRcdFx0XG5cdFx0fTtcblx0XHRcblx0XHRcblx0XHR0aGlzLnNldEN1cnJlbnRPcGVyYXRpb24gPSBmdW5jdGlvbiAob3ApIHtcblx0XHRcdFxuXHRcdFx0aWYgKG9wID09PSBcInJlc3VsdGFudFwiKSB7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAobnVtYmVyU3RhY2sgPT09IDIpIHtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRleGVjdXRlT3BlcmF0aW9uKCk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0bnVtYmVyU3RhY2sucHVzaChOdW1iZXIoY3VycmVudE51bWJlcikpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKG51bWJlclN0YWNrKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpbnB1dERpcnR5ID0gZmFsc2U7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8qKlxuXHRcdFx0ICogSWYgdGhlcmUgaXMgbm90aGluZyBpbiBudW1iZXJTdGFjayAmIHRoZXJlIGlzIG5vIGlucHV0LCBkbyBub3RoaW5nXG5cdFx0XHQgKiBJZiB0aGVyZSBpcyBub3RoaW5nIGluIG51bWJlclN0YWNrICYgdGhlcmUgaXMgaW5wdXQsIGRlZmluZSBhbiBvcGVyYXRpb25cblx0XHRcdCAqL1xuXHRcdFx0XG5cdFx0XHRpZiAobnVtYmVyU3RhY2subGVuZ3RoID09PSAwICYmICFpbnB1dERpcnR5KSB7XG5cdFx0XHRcdFxuXHRcdFx0XHRjb25zb2xlLmxvZyhcIlRoZXJlIGlzIG5vdGhpbmcgdG8gb3BlcmF0ZSBvblwiKTtcblx0XHRcdFx0XG5cdFx0XHR9IGVsc2UgaWYgKG51bWJlclN0YWNrLmxlbmd0aCA9PT0gMCAmJiBpbnB1dERpcnR5KSB7XG5cdFx0XHRcdFxuXHRcdFx0XHRjb25zb2xlLmxvZyhcIlRoZXJlIGlzIHNvbWV0aGluZyB0byBwdXQgaW4gdGhlIHN0YWNrIVwiKTtcblx0XHRcdFx0XG5cdFx0XHRcdGN1cnJlbnRPcGVyYXRpb24gPSBvcDtcblx0XHRcdFx0XG5cdFx0XHRcdG51bWJlclN0YWNrLnB1c2goTnVtYmVyKGN1cnJlbnROdW1iZXIpKTtcblx0XHRcdFx0Y29uc29sZS5sb2cobnVtYmVyU3RhY2spO1xuXHRcdFx0XHRpbnB1dERpcnR5ID0gZmFsc2U7XG5cdFx0XHRcdFxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvKiogSWYgdGhlcmUgaXMgb25lIGVsZW1lbnQgaW4gbnVtYmVyU3RhY2sgJiB0aGVyZSBpcyBubyBpbnB1dCxcblx0XHRcdCAqIGRlZmluZSBhbiBvcGVyYXRpb24gb3IgYWxsb3cgdG8gc3dpdGNoIG9wZXJhdGlvbnNcblx0XHRcdCAqIElmIHRoZXJlIGlzIG9uZSBlbGVtZW50IGluIG51bWJlclN0YWNrICYgdGhlcmUgaXMgaW5wdXQsXG5cdFx0XHQgKiBwdXNoIHRoZSBpbnB1dCBpbnRvIG51bWJlclN0YWNrXG5cdFx0XHQgKi9cblx0XHRcdFxuXHRcdFx0aWYgKG51bWJlclN0YWNrLmxlbmd0aCA9PT0gMSAmJiAhaW5wdXREaXJ0eSkge1xuXHRcdFx0XHRcblx0XHRcdFx0Y29uc29sZS5sb2coXCJUaGVyZSBpcyBhbiBlbGVtZW50IGluIHRoZSBzdGFja1wiKTtcblx0XHRcdFx0Y3VycmVudE9wZXJhdGlvbiA9IG9wO1xuXHRcdFx0XHRjb25zb2xlLmxvZyhjdXJyZW50T3BlcmF0aW9uKTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmIChvcCA9PT0gXCJwZXJjZW50YWdlXCIpIHtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRleGVjdXRlT3BlcmF0aW9uKCk7XG5cdFx0XHRcdFx0bnVtYmVyU3RhY2sucHVzaChOdW1iZXIoY3VycmVudE51bWJlcikpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0fSBlbHNlIGlmIChudW1iZXJTdGFjay5sZW5ndGggPT09IDEgJiYgaW5wdXREaXJ0eSkge1xuXHRcdFx0XHRcblx0XHRcdFx0bnVtYmVyU3RhY2sucHVzaChOdW1iZXIoY3VycmVudE51bWJlcikpO1xuXHRcdFx0XHRjb25zb2xlLmxvZyhudW1iZXJTdGFjayk7XG5cdFx0XHRcdGlucHV0RGlydHkgPSBmYWxzZTtcblx0XHRcdFx0XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBUaGlzIHdpbGwgbWFrZSB0aGUgZXhlY3V0aW9uIGJsb2NrIHRvIHJ1bi5cblx0XHRcdFx0ICogVGhlIG9wZXJhdGlvbiB0aGF0IHdhcyBhc3NpZ25lZCB0byB0cmlnZ2VyIHRoZSBleGVjdXRpb25cblx0XHRcdFx0ICogd2lsbCBiZSBzdG9yZWQgYWZ0ZXIgdGhlIGV4ZWN1dGlvbiBpcyBkb25lIGFzIGl0IHdpbGxcblx0XHRcdFx0ICogbGVhdmUgb25lIGVsZW1lbnQgaW4gdGhlIHN0YWNrIHJlYWR5IHRvIGFuIG9wZXJhdGlvblxuXHRcdFx0XHQgKi9cblx0XHRcdFx0XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8qKlxuXHRcdFx0ICogSWYgdGhlcmUgYXJlIHR3byBlbGVtZW50cyBpbiBudW1iZXJTdGFjayxcblx0XHRcdCAqIGV4ZWN1dGUgdGhlIGN1cnJlbnQgb3BlcmF0aW9uXG5cdFx0XHQgKi9cblx0XHRcdFxuXHRcdFx0aWYgKG51bWJlclN0YWNrLmxlbmd0aCA9PT0gMikge1xuXHRcdFx0XHRcblx0XHRcdFx0Y29uc29sZS5sb2coXCJFeGVjdXRlIE9wZXJhdGlvblwiKTtcblx0XHRcdFx0XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBUaGUgY3VycmVudCBvcGVyYXRpb24gY291bGQgY2hhbmdlIHByaW9yIHRvIGNvbXB1dGF0aW9uXG5cdFx0XHRcdCAqIHdoZW4gdXNpbmcgdGhlIHBlcmNlbnRhZ2Ugb3BlcmF0b3IgKCUpIGFzIGEgYmluYXJ5IG9wZXJhdG9yXG5cdFx0XHRcdCAqL1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKG9wID09PSBcInBlcmNlbnRhZ2VcIikge1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGxldCBvbmdvaW5nT3AgPSBjdXJyZW50T3BlcmF0aW9uO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGN1cnJlbnRPcGVyYXRpb24gPSBvcDtcblx0XHRcdFx0XHRleGVjdXRlT3BlcmF0aW9uKCk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Y3VycmVudE9wZXJhdGlvbiA9IG9uZ29pbmdPcDtcblx0XHRcdFx0XHRleGVjdXRlT3BlcmF0aW9uKCk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0bnVtYmVyU3RhY2sucHVzaChOdW1iZXIoY3VycmVudE51bWJlcikpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0XG5cdFx0XHRcdGV4ZWN1dGVPcGVyYXRpb24oKTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIE9wZXJhdGlvbiBpcyBjb21wbGV0ZS4gQWRkIHJlc3VsdCB0byBudW1iZXJTdGFja1xuXHRcdFx0XHRcblx0XHRcdFx0bnVtYmVyU3RhY2sucHVzaChOdW1iZXIoY3VycmVudE51bWJlcikpO1xuXHRcdFx0XHRcblx0XHRcdFx0Y29uc29sZS5sb2cobnVtYmVyU3RhY2spO1xuXHRcdFx0XHRcblx0XHRcdFx0Y3VycmVudE9wZXJhdGlvbiA9IG9wO1xuXHRcdFx0XHRjb25zb2xlLmxvZyhjdXJyZW50T3BlcmF0aW9uKTtcblx0XHRcdFx0XG5cdFx0XHR9XG5cdFx0XHRcblx0XHR9O1xuXHRcdFxuXHRcdHRoaXMuY2xlYXJCb2FyZCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFxuXHRcdFx0Y29uc29sZS5sb2coXCJDTEVBUlwiKTtcblx0XHRcdFxuXHRcdFx0ZW1wdHlCb2FyZCA9IHRydWU7XG5cdFx0XHRcblx0XHRcdG51bWJlclN0YWNrLmxlbmd0aCA9IDA7XG5cdFx0XHRcblx0XHRcdGN1cnJlbnROdW1iZXIgPSAwO1xuXHRcdFx0Y3VycmVudE9wZXJhdGlvbiA9IG51bGw7XG5cdFx0XHRjdXJyZW50T3BlcmF0aW9uUmVzdWx0ID0gbnVsbDtcblx0XHRcdFxuXHRcdFx0ZGVjaW1hbENyZWF0ZWQgPSBmYWxzZTtcblx0XHRcdFxuXHRcdFx0aW5wdXREaXJ0eSA9IGZhbHNlO1xuXHRcdFx0XG5cdFx0fTtcblx0XHRcblx0XHR0aGlzLmZsaXBTaWduID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XG5cdFx0XHRjb25zb2xlLmxvZyhcImZsaXBTaWduXCIpO1xuXHRcdFx0XG5cdFx0XHRpZiAoY3VycmVudE51bWJlciA9PSAwIHx8IGVtcHR5Qm9hcmQpIHtcblx0XHRcdFx0XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBBdm9pZCBOYU5cblx0XHRcdFx0ICovXG5cdFx0XHRcdFxuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRcblx0XHRcdGlmIChudW1iZXJTdGFjay5sZW5ndGggPT09IDEgJiYgIWlucHV0RGlydHkpIHtcblx0XHRcdFx0XG5cdFx0XHRcdGxldCB0ZW1wTnVtID0gbnVtYmVyU3RhY2sucG9wKCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRjdXJyZW50TnVtYmVyID0gdGVtcE51bSAqIC0xO1xuXHRcdFx0XHRcblx0XHRcdFx0bnVtYmVyU3RhY2sucHVzaChOdW1iZXIoY3VycmVudE51bWJlcikpO1xuXHRcdFx0XHRcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFxuXHRcdFx0XHRjb25zb2xlLmxvZyhudW1iZXJTdGFjayk7XG5cdFx0XHRcdFxuXHRcdFx0XHRjdXJyZW50TnVtYmVyID0gY3VycmVudE51bWJlciAqIC0xO1xuXHRcdFx0XHRcblx0XHRcdH1cblx0XHRcdFxuXHRcdH1cblx0XHRcblx0fSk7XG4iXX0=
